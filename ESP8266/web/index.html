<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0,minimum-scale=1.0, user-scalable=0" />
	<meta http-equiv="Cache-Control" content="no-transform">
	<meta http-equiv="Cache-Control" content="no-siteapp">
	<title>GT-Clock8266</title>
	<link rel="stylesheet" type="text/css" href="assets/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="assets/bootflat.min.css">
	<link rel="stylesheet" type="text/css" href="assets/datetimepicker.min.css">
	<style>
		.mb0{
			margin-bottom: 0;
		}
		#tfp{
			width: 288px;
			height: 24px;
			margin: auto;
			background: url('assets/timeFontPreview.png') no-repeat top left;
			background-size: 288px;
			image-rendering: pixelated;
			transition: background-position ease-out 0.3s;
		}
		@media (max-width: 480px) {
			#tfp{
				width: 180px;
			}
		}
		@media(max-width: 335px){
			#tfp{
				width: 100%;
			}
		}
		#fp{
			width: 240px;
			height: 24px;
			margin: auto;
			background: url('assets/normalFontPreview.png') no-repeat top left;
			background-size: 240px;
			image-rendering: pixelated;
			transition: background-position ease-out 0.3s;
		}
		@media (max-width: 480px) {
			#fp{
				width: 100%;
			}
		}
		#tsp{
			width: 120px;
			height: 24px;
			margin: auto;
			background: url('assets/timestylenewpreview.png') no-repeat top left;
			background-size: 120px;
			image-rendering: pixelated;
			transition: background-position ease-out 0.3s;
		}
	</style>
</head>
<body style="padding-top: 70px; background-color: #f1f2f6">
<nav class="navbar navbar-inverse navbar-fixed-top" id="nav"></nav>

<div class="container" id="main">
	<noscript>
		<div class="alert alert-danger text-center">This page contains instant messaging quests and requires Javascript allowed during setup, otherwise, some options may not working property.</div>
	</noscript>
	<div class="jumbotron">
		<div class="jumbotron-photo center">
		</div>
		<div class="jumbotron-contents">
			<h1 class="text-center" style="margin-top: 10px">Welcome</h1>
			<p>Thanks for using GT network clock, we need to apply some settings before start using it. To confirm all settings by click "Save & Apply" button.</p>
			<p>You can just satisfied the clock time locally from your PC or phone for minimum working. For advanced functions, please check WiFi settings and ensure the internet accessible.</p>
		</div>
	</div>
	<div class="row clearfix">
		<div class="col-xs-12 col-md-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Time Settings</h3>
				</div>
				
				<ul class="list-group">
					<li class="list-group-item">
						<label>Local time</label>
						<div class="input-group">
							<input type="text" class="form-control dtset" id="idt" placeholder="yyyy-MM-dd HH:mm:ss" readonly/>
							<span class="input-group-btn"><button class="btn btn-primary" type="button" id="bsldt">Sync Localtime</button></span>
						</div>
						<p class="help-block">Touch the input box to select time, or click "Sync Localtime" to assign localtime to page. It will automatically update when set and send to device at the end.</p>
					</li>
					<li class="list-group-item">
						<label><input type="checkbox" id="cundt"> Time Synchronization via Internet</label>
						<div class="alert alert-warning">Your device is not connected to the internet, time synchronization service may not work properly.</div>
						<p class="help-block">Obtain the latest network time through the network NTP server and synchronize it to the device.</p>
						<div class="input-group">
							<span class="input-group-addon">Preferred time server</span>
							<select class="form-control" id="sts1" disabled></select>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">Alternative time server</span>
							<select class="form-control" id="sts2" disabled></select>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">Timezone</span>
							<span class="input-group-addon">UTC</span>
							<select class="form-control" id="stz" disabled></select>
							<span class="input-group-btn">
									<button class="btn btn-primary" type="button" id="bsltz" disabled>Sync local timezone</button>
								</span>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">Summer time</span>
							<select class="form-control" id="sdst" disabled></select>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">Synchronization frequency</span>
							<select class="form-control" id="ssf" disabled></select>
						</div>
					</li>
					<li class="list-group-item">
						<label>RTC Device</label>
						<p class="help-block">Select an RTC device and let time storing in specified device.</p>
						<p class="help-block">Ensure backup battery of RTC device working properly, otherwise may lost time after shutdown.</p>
						<div class="input-group">
							<span class="input-group-addon">RTC device</span>
							<select class="form-control" id="srtc">
								<option value="1">DS3231</option>
								<option value="2">STM32</option>
							</select>
						</div><br>
					</li>
				</ul>
			</div>
			
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Display setting</h3>
				</div>
				<div class="panel-body">
					<label>Display mode, font and dot matrix tuning</label>
					<div class="input-group">
						<span class="input-group-addon">Preview</span>
						<div class="form-control" style="overflow: hidden">
							<div id="tfp"></div>
						</div>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Time font</span>
						<select class="form-control" id="tf">
							<option value="0">Please Wait...</option>
						</select>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Preview</span>
						<div class="form-control" style="overflow: hidden">
							<div id="tsp"></div>
						</div>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Time style</span>
						<select class="form-control" id="sts"></select>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Alignment</span>
						<select class="form-control" id="sta"></select>
					</div>
					<p class="help-block">If choose a font with height of 7, it can configure alignment top or bottom to display, leaving a one pixel line blank in the relative position.</p>
					<label><input type="checkbox" id="c3"> '0' before non-two-digit of hour</label>
					<p>Add '0' before hour while it not exceed two digits</p>
				</div>
				<ul class="list-group">
					<li class="list-group-item">
						<label>Normal font</label>
						<div class="input-group">
							<span class="input-group-addon">preview</span>
							<div class="form-control" style="overflow: hidden">
								<div id="fp"></div>
							</div>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">font</span>
							<select class="form-control" id="sf">
								<option value="0">Please Wait...</option>
							</select>
						</div><br>
					</li>
					<li class="list-group-item">
						<label>Date display method</label>
						<div class="input-group">
							<span class="input-group-addon">Date format</span>
							<select class="form-control" id="sdf"></select>
						</div><br>
						<label><input type="checkbox" id="c3"> '0' before non-two-digit of date</label>
						<p>Add '0' before month or day while it not exceed two digits</p>
					</li>
					<li class="list-group-item">
						<label>Week display method</label>
						<div class="input-group">
							<span class="input-group-addon">Week format</span>
							<select class="form-control" id="swf"></select>
						</div><br>
						<div class="input-group">
							<span class="input-group-addon">Week position</span>
							<select class="form-control" id="swl"></select>
						</div><br>
					</li>
				</ul>
			</div>
		</div>
		
		<div class="col-xs-12 col-md-6">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Temperature</h3>
				</div>
				<div class="panel-body">
					<label>Mode & settings</label>
					<div class="input-group">
						<span class="input-group-addon">Source</span>
						<select class="form-control" id="std"></select>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Unit</span>
						<select class="form-control" id="stu"></select>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Automatic schedule</span>
						<select class="form-control" id="stad"></select>
					</div>
				</div>
			</div>
			
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Other settings</h3>
				</div>
				<div class="panel-body">
					<label>Hourly reminding, automatic brightness</label>
					<div class="input-group">
						<span class="input-group-addon">Hourly reminding</span>
						<select class="form-control" id="shr"></select>
					</div>
				</div>
				<ul class="list-group">
					<li class="list-group-item">
						<label><input type="checkbox" id="csan"> Silent at night</label>
						<p>Stop buzzer at night so as not to effect night sleep.</p>
					</li>
					<li class="list-group-item">
						<label><input type="checkbox" id="cab"> Automatic brightness</label>
						<p>Use light sensor to adjust screen brightness automatically</p>
					</li>
					<li class="list-group-item">
						<label><input type="checkbox" id="caso"> Automatic screen orientation</label>
						<p>Use gravity switch to adjust screen orientation automatically</p>
					</li>
				</ul>
			</div>
			
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">Network</h3>
				</div>
				<div class="panel-body">
					<label>WiFi AP</label>
					<p class="help-block">
						This device contains an ESP8266 wireless transceiver, which can be connected to an external 2.4GHz AP to access the Internet. You can manually enter or select SSID below and corresponding password to get network permissions. Device will connect the saved AP after reboot automatically.
					</p>
					<div class="input-group">
						<span class="input-group-addon">ESSID</span>
						<input type="text" class="form-control" id="iessid" placeholder=""/>
					</div><br>
					<div class="input-group">
						<span class="input-group-addon">Password</span>
						<input type="password" class="form-control" id="iwp" placeholder="Password not changed" />
					</div>
					<p class="help-block">If password of AP not changed, please leave it blank to use default.</p>
				</div>
				<ul class="list-group">
					<li class="list-group-item">
						<label>Available APs</label>
						<div class="input-group">
							<select class="form-control" id="swa">
								<option value="1">One</option>
								<option value="2">Two</option>
								<option value="3">Three</option>
								<option value="4">Four</option>
								<option value="5">Five</option>
								<option value="6">Six</option>
								<option value="7">Seven</option>
								<option value="8">Eight</option>
							</select>
							<span class="input-group-btn">
								<button class="btn btn-success" type="button" id="bwc">Select AP</button>
							</span>
						</div><br>
						<div class="input-group">
							<button class="btn btn-primary" type="button" id="bws">Scan available networks</button>
						</div>
					</li>
					<li class="list-group-item">
						<label>DNS resolution</label>
						<div class="input-group">
							<span class="input-group-addon">DNS</span>
							<input type="text" class="form-control" id="idns"/>
						</div>
						<p>It will using default DNS address if leave it blank.</p>
					</li>
				</ul>
			</div>
			
			<div class="panel panel-danger">
				<div class="panel-heading">
					<h3 class="panel-title">Interactive button</h3>
				</div>
				<ul class="list-group">
					<li class="list-group-item">
						<label>Press once</label>
						<div class="input-group">
							<select class="form-control" id="s1">
								<option value="1">Sync time from network</option>
								<option value="2">Sleep</option>
								<option value="3">Weather forecast</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
							</select>
							<span class="input-group-btn">
								<button class="btn btn-success" type="button" id="p1">Button</button>
							</span>
						</div><br>
					</li>
					<li class="list-group-item">
						<label>Long press</label>
						<div class="input-group">
							<select class="form-control" id="s2">
								<option value="1">Shutdown system</option>
								<option value="2">Close display</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
							</select>
							<span class="input-group-btn">
								<button class="btn btn-success" type="button" id="p2">Button</button>
							</span>
						</div><br>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>

<nav class="navbar navbar-inverse mb0">
	<div class="container-fluid">
		<div class="navbar-collapse navbar-right">
			<button type="button" class="btn btn-danger navbar-btn" id="bs">Save & apply</button>
		</div>
		<div class="navbar-header">
			<a href="javascript:void(0);" class="navbar-brand">Copyright 2010 - 2020 GT-Soft Studio</a>
		</div>
	</div>
</nav>

<script type="text/javascript" src="assets/jquery2.min.js"></script>
<script type="text/javascript" src="assets/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/moment.min.js"></script>
<!--<script type="text/javascript" src="assets/moment_zh-cn.js"></script>-->
<script type="text/javascript" src="assets/datetimepicker.min.js"></script>
<script type="text/javascript" src="assets/h.js"></script>
<script type="text/javascript">
	$(function(){
		let
			timeFontTrigger = function(t, targetValue){
				$(t).css("background-position-y", -targetValue * 24);
			},
			setEnable = function(jds, e){
				jds.forEach(function(v){
					$(v).attr("disabled", e);
				});
			},
			mf = "YYYY-MM-DD HH:mm:ss";
		$.get("assets/nav.html", function(d){
			$("#nav").html(d);
		}).fail(function(){
			showError("The specified URL returns an error");
		});
		$.getJSON("assets/setup.json", function(j){
			if(typeof(j) != "object"){
				throw Error("Setup file was corrupted.");
			}
			for(let k in j){
				try {
					if (typeof (j[k]) != "object") {
						throw Error("Setup file item was corrupted");
					}
					for(let val in j[k]){
						//selInsOpt($(k), val, j[k][val]);
						//console.log("输入到:" + k + " 选项:" + j[k][val] + " 值:" + val);
						if(typeof(j[k][val]) === "object"){
							selInsOpt($(k), val, j[k][val]["value"], j[k][val]);
						}else{
							selInsOpt($(k), val, j[k][val]);
						}
					}
				} catch(e){
					console.error(e);
					continue;
				}
			}
		}).fail(function(){
			showError("The specific URL returns an error.");
		});
		$.getJSON("assets/fonts.json", function(j){
			if(typeof(j) != "object"){
				throw Error("Font list json was corrupted.");
			}
			$("#tf").html("");
			$("#sf").html("");
			for(let k in j){
				try{
					if(typeof(j[k]) != "object"){
						throw Error("Font list json was corrupted.");
					}
					for(let val in j[k]){
						selInsOpt($(k), "", val, j[k][val]);
						console.log("输入到:" + k + " 选项:" + j[k][val] + " 值:" + val);
						
					}
					
					
				}catch(e){
					console.error(e);
					continue;
				}
			}
		}).fail(function(){
			showError("The specific URL returns an error.");
		});
		$(".dtset").datetimepicker({format: "YYYY-MM-DD HH:mm:ss",ignoreReadonly:true,widgetPositioning:{horizontal:"auto",vertical:"bottom"}});

		$("#bsltz").click(function(){
			$("#stz").val(moment().utcOffset() / 60);
		});
		$("#cundt").change(function(e){
			setEnable(["#sts1", "#sts2", "#stz", "#ssf", "#sdst", "#bsltz"], !e.target.checked);
			e.target.checked && $("#bsltz").click();
		});
		$("#tf").change(function(e){
			let selectedOption = $(this).find("option[value=" + e.target.value + "]");
			timeFontTrigger("#tfp", selectedOption.data("no"));
			$(this).data("w", selectedOption.data("w"));
			$(this).data("h", selectedOption.data("h"));
		});
		$("#sf").change(function(e){
			timeFontTrigger("#fp", $(this).find("option[value=" + e.target.value + "]").data("no"));
		});
		$("#sts").change(function(e){
			timeFontTrigger("#tsp", e.target.value - 1);
			let dataf = $(this).find("option[value=" + e.target.value + "]").data("f");
			if(typeof(dataf) !== "undefined"){
				$("#tf").val(dataf).change();
				//fontname = $("#tf").find("option[value=" + dataf + "]").html();
			}else{
				$("#tf").val(1).change();
			}
		});
		$("#bwc").click(function(e){
			$("#iessid").val($("#swa").val());
		});
		$(function(){
			let
				tid = -1,
				ct = 0,
				udt = function(jd){
					ct.add(1, "second");
					jd.val(ct.format(mf));
				};
			$("#idt").focus(function(e){
				if(tid != -1){
					clearInterval(tid);
					tid = -1;
					console.log("Timer Cleared");
				}
			}).blur(function(e){
				if(tid == -1){
					if($(this).val() != ""){
						ct = moment($(this).val(), mf);
						if(ct.isValid){
							tid = setInterval(udt, 1000, $(this));
							console.log("Set Interval: " + tid);
						}
					}
				}
			}).blur();
			$("#bsldt").click(function(){
				ct = moment();
				$("#idt").val(ct.format(mf)).blur();
			});
		});

	})
</script>
</body>
</html>
